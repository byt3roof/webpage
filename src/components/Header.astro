---
interface Props {
    data: {
        title: string;
        sections: {
            title: string;
            href: string;
        }[];
        contactButton: {
            text: string;
            href: string;
        };
    };
}

const { data } = Astro.props;
---

<header class="header">
    <div class="container header-content">
        <a href="/" class="logo">{data.title}</a>

        <button class="menu-toggle" aria-label="Toggle menu">
            <span class="material-icons">menu</span>
        </button>

        <nav class="nav">
            <ul class="nav-list">
                {
                    data.sections.map((section) => (
                        <li>
                            <a href={section.href} class="nav-link">
                                {section.title}
                            </a>
                        </li>
                    ))
                }
                <li class="mobile-only">
                    <a
                        href={`https://${data.contactButton.href}`}
                        class="nav-link"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        {data.contactButton.text}
                    </a>
                </li>
            </ul>
        </nav>

        <a
            href={`https://${data.contactButton.href}`}
            class="btn btn-contact desktop-only"
            target="_blank"
            rel="noopener noreferrer"
        >
            {data.contactButton.text}
        </a>
    </div>
</header>

<script>
    const menuToggle = document.querySelector(".menu-toggle");
    const nav = document.querySelector(".nav");
    const body = document.body;

    menuToggle?.addEventListener("click", () => {
        nav?.classList.toggle("active");
        body.classList.toggle("no-scroll");

        const icon = menuToggle.querySelector(".material-icons");
        if (icon) {
            icon.textContent = nav?.classList.contains("active")
                ? "close"
                : "menu";
        }
    });

    // Close menu when clicking a link
    document.querySelectorAll(".nav-link").forEach((link) => {
        link.addEventListener("click", () => {
            nav?.classList.remove("active");
            body.classList.remove("no-scroll");
            const icon = menuToggle?.querySelector(".material-icons");
            if (icon) icon.textContent = "menu";
        });
    });
</script>

<style>
    .header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: rgba(10, 10, 10, 0.9);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border-color);
        z-index: 1000;
        padding: var(--spacing-sm) 0;
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .logo {
        font-size: 1.5rem;
        font-weight: 800;
        color: #fff;
        letter-spacing: -0.05em;
        z-index: 1001;
    }

    .nav-list {
        display: flex;
        gap: var(--spacing-md);
        align-items: center;
    }

    .nav-link {
        color: var(--text-muted);
        font-weight: 500;
        font-size: 0.95rem;
    }

    .nav-link:hover {
        color: #fff;
    }

    .btn-contact {
        padding: 0.5rem 1.2rem;
        font-size: 0.9rem;
    }

    .menu-toggle {
        display: none;
        background: none;
        border: none;
        color: #fff;
        cursor: pointer;
        position: relative; /* Ensure z-index works */
        z-index: 1001;
    }

    .mobile-only {
        display: none;
    }

    @media (max-width: 768px) {
        .menu-toggle {
            display: block;
        }

        .desktop-only {
            display: none;
        }

        .mobile-only {
            display: block;
            margin-top: var(--spacing-md);
        }

        .nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            z-index: 1000;
        }

        .nav.active {
            transform: translateX(0);
        }

        .nav-list {
            flex-direction: column;
            text-align: center;
            gap: var(--spacing-lg);
        }

        .nav-link {
            font-size: 1.5rem;
        }

        /* Style for the mobile contact button */
        .mobile-only .nav-link {
            background-color: var(--primary-color);
            color: #000;
            padding: 0.8rem 2rem;
            border-radius: 4px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .mobile-only .nav-link:hover {
            background-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 255, 157, 0.2);
        }
    }
</style>
